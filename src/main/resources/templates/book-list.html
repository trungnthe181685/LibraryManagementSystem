<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
	<title>Book List</title>
	<link rel="stylesheet" href="/css/kiet.css">
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet">
	<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
</head>

<body>

    <!-- Navbar -->
    <div th:replace="navbar :: navbar"></div>

    <div class="container mt-4">
        <h1 class="mb-4">All Books</h1>

        <!-- Filter Form -->
        <div class="card p-3 mb-5">
            <form method="get" action="/books">
                <div class="row g-3">
                    <!-- Categories -->
                    <div class="col-md-4">
                        <label class="form-label">Categories:</label>
                        <div class="form-check" th:each="cat : ${categories}">
                            <input class="form-check-input" type="checkbox" name="categoryIds"
                                th:value="${cat.bookCategoryID}"
                                th:checked="${selectedCategoryIds != null and selectedCategoryIds.contains(cat.bookCategoryID)}" />
                            <label class="form-check-label" th:text="${cat.bookCatName}"></label>
                        </div>
                    </div>

                    <!-- Author Dropdown -->
                    <div class="col-md-4">
                        <label for="author" class="form-label">Author:</label>
                        <select class="form-select" name="authorId" id="author">
                            <option value="">All</option>
                            <option th:each="a : ${authors}" th:value="${a.authorID}" th:text="${a.authorName}"
                                th:selected="${a.authorID == selectedAuthorId}">
                            </option>
                        </select>
                    </div>

                    <!-- Year Input -->
                    <div class="col-md-4">
                        <label for="year" class="form-label">Published Year:</label>
                        <input class="form-control" type="number" name="year" id="year" placeholder="e.g. 2023"
                            th:value="${selectedYear}" />
                    </div>
                </div>

                <div class="mt-3">
                    <button type="submit" class="btn btn-primary"><i class="bi bi-funnel"></i> Filter</button>
					<a th:href="@{/books}" class="btn btn-sm btn-danger flex-fill">
												                    <span class="text">Unselect all</span>
												                </a>
                </div>
            </form>
        </div>

        <!-- Book Cards -->
        <div class="row row-cols-1 row-cols-md-4 g-4">
            <div class="col" th:each="book : ${books}">
                <div class="card h-100 shadow-sm">
                    <a th:href="@{/books/{id}(id=${book.bookID})}">
                        <img th:src="${book.imageURL}" class="card-img-top" alt="Book Cover" height="250"
                            style="object-fit: cover;">
                    </a>
                    <div class="card-body d-flex flex-column">
                        <h5 class="card-title" th:text="${book.bookName}">Book Name</h5>
                        <p class="card-text mb-2">
                            <strong>Author:</strong>
                            <span th:text="${book.author != null ? book.author.authorName : 'N/A'}">Author</span><br />
<strong>Year:</strong> <span th:text="${book.publishedDate}">Date</span>
                        </p>
						<a th:href="@{/books/{id}(id=${book.bookID})}" class="readmore-btn">
							                    <span class="text">Read more</span>
							                </a>
                    </div>
                </div>
            </div>
        </div>

    </div>

</body>

</html>